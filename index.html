<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style type="text/css">
		body {
			font-size: 14px;
		}

		table {
			width: 960px;
			margin: 0px auto;
			border-collapse: collapse;
			background: #999;
		}
		div {
			width: 960px;
			margin: 10px auto 15px;
			text-align: center;
		}
		h3 {
			margin: 10px auto;
		}
		table td {
			border: 1px solid #382F27;
			text-align: center;
			padding: 3px 3px;
		}

		table input[type=text] {
			width: 95%;
		} 

		/* 高亮样式 */
		.hl {
			background: #ccc;
		}

		h3 {
			margin: 0px;
			padding: 0px;
			font-size: 18px;
			font-weight: bold;
			color: #fff;
		}		

	</style>

	
</head>
<body>
	<table id="table1">
		<tr>
			<td colspan="8">
				<h3>项目列表</h3>
			</td>
		</tr>
		<tr>
			<td>选择</td>
			<td>编号</td>
			<td>项目名称</td>
			<td>项目承担部门</td>
			<td>责任人</td>
			<td>项目预算</td>
			<td>开始日期</td>
			<td>备注</td>
		</tr>
		<tr>
			<td><input type="radio" name="check"></td>
			<td>1</td>
			<td>项目测试1</td>
			<td>部门1</td>
			<td>张三</td>
			<td>￥8888.0</td>
			<td>2015-10-13</td>
			<td>...</td>
		</tr>
		<tr>
			<td><input type="radio" name="check"></td>
			<td>2</td>
			<td>项目测试2</td>
			<td>部门2</td>
			<td>张三</td>
			<td>￥8888.0</td>
			<td>2015-10-13</td>
			<td>...</td>
		</tr>
		<tr>
			<td><input type="radio" name="check"></td>
			<td>3</td>
			<td>项目测试3</td>
			<td>部门3</td>
			<td>张三</td>
			<td>￥8888.0</td>
			<td>2015-10-13</td>
			<td>...</td>
		</tr>
		<tr>
			<td><input type="radio" name="check"></td>
			<td>4</td>
			<td>项目测试4</td>
			<td>部门4</td>
			<td>张三</td>
			<td>￥8888.0</td>
			<td>2015-10-13</td>
			<td>...</td>
		</tr>
		<tr>
			<td><input type="radio" name="check"></td>
			<td>5</td>
			<td>项目测试5</td>
			<td>部门5</td>
			<td>张三</td>
			<td>￥8888.0</td>
			<td>2015-10-13</td>
			<td>...</td>
		</tr>
		<tr>
			<td><input type="radio" name="check"></td>
			<td>6</td>
			<td>项目测试6</td>
			<td>部门6</td>
			<td>张三</td>
			<td>￥8888.0</td>
			<td>2015-10-13</td>
			<td>...</td>
		</tr>
		<tr>
			<td><input type="radio" name="check"></td>
			<td>7</td>
			<td>项目测试7</td>
			<td>部门7</td>
			<td>张三</td>
			<td>￥8888.0</td>
			<td>2015-10-13</td>
			<td>...</td>
		</tr>
		<tr>
			<td colspan="8">
				<span>共12条记录，每页7条，共2页，当前第1页</span>
				<a href="#">首页</a>
				<a href="#">上页</a>
				<a href="#">下页</a>
				<a href="#">末页</a>
			</td>
		</tr>
	</table>
	<div><input type="button" id="btn" value="项目维护"></div>
	<table id="table2">
		<tr>
			<td colspan="4">
				<h3>项目信息维护</h3>
			</td>
		</tr>
		<tr>
			<td>项目名称</td>
			<td><input type="text" id="name"></td>
			<td>项目承担部门</td>
			<td><input type="text" id="department"></td>
		</tr>
		<tr>
			<td>责任人</td>
			<td><input type="text" id="person"></td>
			<td>项目预算</td>
			<td><input type="text" id="budget"></td>
		</tr>
		<tr>
			<td>开始日期</td>
			<td><input type="text" id="date"></td>
			<td>备注</td>
			<td><input type="text" id="remark"></td>
		</tr>
		<tr>
			<td colspan="4">
				<input type="button" id="add" value="添加">
				<input type="button" id="update" value="修改" disabled>
				<input type="button" id="del" value="删除" disabled>
				<input type="button" id="search" value="查询">
				<input type="button" id="clear" value="清除">
			</td>
		</tr>
	</table>
	<script type="text/javascript" src="js/jquery.js"></script>
	
	<script type="text/javascript">
		$(function(){
			
			//增加数据功能
			
			$('#add').click(function(e){
				
				var num = 0;//自动编号
				//判断如果没有数据行，编号从1开始，有数据从最后一个开始
				if($('#table1 tr').length == 3){
					num = 1;
				}else{
					num = parseInt($('#table1 tr:last').prev('tr').find('td').eq(1).text()) + 1;
				}
				//td的数据封装为一个对象
				var obj = {
					radio:'<input type="radio" name="check">',
					num:num,
					name:$('#name').val(),
					department:$('#department').val(),
					person:$('#person').val(),
					budget:$('#budget').val(),
					date:$('#date').val(),
					remark:$('#remark').val()
				};
				
				var tr = $('<tr></tr>').insertBefore('#table1 tr:last');
				//追加td单元格到tr中
				
				tr.append('<td>'+ obj.radio + '</td>');
				tr.append('<td>'+ obj.num + '</td>');
				tr.append('<td>'+ obj.name + '</td>');
				tr.append('<td>'+ obj.department + '</td>');
				tr.append('<td>'+ obj.person + '</td>');
				tr.append('<td>'+ obj.budget + '</td>');
				tr.append('<td>'+ obj.date + '</td>');
				tr.append('<td>'+ obj.remark + '</td>');
				clearAll();
			});
			//利用事件委托给所有的单选按钮加单击事件
			
			$('#table1').on('click',':radio[name=check]',function(){
				highLight();
				var tds = $(this).parents('tr').find('td');
				//填充表单数据
				$('#name').val( tds.eq(2).text() );
				$('#department').val( tds.eq(3).text() );
				$('#person').val( tds.eq(4).text() );
				$('#budget').val( tds.eq(5).text() );
				$('#date').val( tds.eq(6).text() );
				$('#remark').val( tds.eq(7).text() );
				
				//修改，删除按钮为可用
				$('#update,#del').prop('disabled',false);
				
			});
			
			
			$('#del').click(function(){
				
				//删除当前高亮行
				$('#table1 .hl').remove();
				clearAll();
				
			});
			//修改数据
			$('#update').click(function(){
				
				var tds = $('#table1 .hl').find('td');
				
				tds.eq(2).text( $('#name').val() );
				tds.eq(3).text( $('#department') .val());
				tds.eq(4).text( $('#person').val() );
				tds.eq(5).text( $('#budget').val() );
				tds.eq(6).text( $('#date').val() );
				tds.eq(7).text( $('#remark').val() );
				
				clearAll();
				
			});
			
			
			
			$('#clear').click(function(){
				clearAll();
			});
			
			//重置函数
			function clearAll(){
				//取消选中的按钮
				$('#table1 :radio:checked').prop('checked',false);
				$('#table1 .hl').removeClass('hl');
				$('#table2 :text').val('');
				$('#update .del').remove('disabled',false);
				
			}
			
			//高亮函数
			function highLight(){
				//所有行去掉高亮
				$('#table1 .hl').removeClass('hl');
				
				$('#table1 :radio:checked').parents('tr').addClass('hl');
				
			}
			
			//双击事件委托
			
			$('#table1').on('dblclick','tr:gt(1):not(:last) td',function(){
				
				if ($(this).index() <= 1) {
					return;
				}
				
				var td = $(this);
				
				var  input = $('<input type="text" id = "editInput">');
				
				var tdWidth=  $(this).width();
				
				input.width(tdWidth)
				$(this).width(tdWidth);
				
				input.val($(this).text());
				
				$(this).html(input);
				
				input.focus();
				
				input.blur(function(){
					
					td.text( this.value);
					
				});
				
				input.keyup(function(e){
					
					if (e.keyCode == 13) {
						td.text( this.value);
					}
					
				});
				input.dblclick(function(){
					return false;
				});
			});
			
		});
	</script>
</body>
</html>